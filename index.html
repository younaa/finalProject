<!DOCTYPE html>

//THIS IS A TEST
<html lang="en">
  <head>
    <title>Ship template</title>
    <style>
      body {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background: #000;
      }

      /* Style the Phaser element here */
      canvas { 
        border: 1px solid #fff; 
      }
    </style>
  </head>
  <body>

    <!-- Include the phaser library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/2.6.2/phaser.min.js"></script>

    <!-- 
      Your game code starts below! 
      PS: (It's a good idea to put this in a separate .js file when it grows too large)
    --> 
    <script>
      "use strict";


      /******* Global variables *******/
      
      const height = 400;
      const width = 400;
      const dragAmount = 0.95;
      const playerAccelerationAmount = 150;
      const playerRotationAmount = 600;
      const playerRotationDrag = 0.7;
      
      let kbd;
        let player;
//        let zap;
      let text;

      // Create the Phaser game
      const game = new Phaser.Game(
        width, height, Phaser.AUTO, '', 
        { preload: preload, create: create, update: update }
      );

      /********************************/
        
        var bullets;
          var bulletTime = 0;
        var fireButton;
      
      // Phaser function to load assets and set up the game
      function preload() {
        game.load.image("player", "cloud.png");
        game.load.image("zap", "lightningbolt2.png");
          game.load.image("bullets", "lightningbolt2.png");
//          game.load.image("tiger","tiger sprite.png");
//          game.load.image("brown bear","")
          
      }

      /********************************/
      
      // Phaser function to set up the initial gamestate
      function create() { 
      
        // Create the player object
        player = game.add.sprite(width / 2, height / 2, "player");
        player.anchor.set(0.5);
      
        // Initialize the player's physics properties
        game.physics.enable(player, Phaser.Physics.ARCADE);
        player.body.collideWorldBounds = true;
        
         
        // Add some text
        text = game.add.text(
          20, 20, "    ", 
          { fontSize: "16px", fill: "#fff", font: "monospace" }
        );

        // Listen for cursor keypresses
        kbd = game.input.keyboard.createCursorKeys();
          
          
        bullets = game.add.group();
        bullets.enableBody = true;
        bullets.physicsBodyType = Phaser.Physics.ARCADE; 
        bullets.createMultiple(30, 'bullets');
        bullets.setAll('anchor,x',0.5);
        bullets.setAll('anchor,y',1);
        bullets.setAll('outOfBoundskill', true);
        bullets.setAll('checkWorldBounds',true);
          
        fireButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
    
      }

      /********************************/
      
      // Phaser function to update and render the game each frame
      function update() {

        // Player rotation
            if (kbd.left.isDown) {
              player.body.angularAcceleration = -playerRotationAmount;
            }
            else if (kbd.right.isDown) {
              player.body.angularAcceleration = playerRotationAmount;
            }
            else {
              player.body.angularAcceleration = 0;
              player.body.angularVelocity *= playerRotationDrag;
            }

            // Player forward/reverse movement
            if (kbd.up.isDown) { // isDown means "pressed" rather than "down arrow key"
              game.physics.arcade.accelerationFromRotation(
                (player.rotation - 1.5708), // THIS LINE
                -playerAccelerationAmount, 
                player.body.acceleration
              );
            }
            else if (kbd.down.isDown) { // Move backward
              game.physics.arcade.accelerationFromRotation(
                (player.rotation - 1.5708), // THIS LINE
                playerAccelerationAmount, 
                player.body.acceleration
              );
            }
            else { // Slow the player down with drag
              player.body.velocity.x *= dragAmount;
              player.body.velocity.y *= dragAmount;
              player.body.acceleration.x *= dragAmount;
              player.body.acceleration.y *= dragAmount;
            }

            if (game.input.activePointer.isDown) {
//                 zap = game.add.sprite(player.x , player.y, "zap");
//                zap.rotation = (player.rotation + 1.5708);
//              zap.anchor.set(0.5);
//              game.physics.enable(zap, Phaser.Physics.ARCADE);
//              zap.body.collideWorldBounds = false;
                     fireBullet();

            }
          
          
          function fireBullet(){
              
             if(game.time.now>bulletTime){
                 var bullet = bullets.getFirstExists(false);
                 if(bullet){
                     bullet.reset(player.x,player.y);
                     bullet.rotation = (player.rotation + 1.5708);
                     bullet.anchor.set(0.5);
                     if(player.x +32 <= 50 && player.y +73<= 50){
                         bullet.body.velocity.x = -100;
                         bullet.body.velocity.y = -100;
                         bulletTime = game.time.now + 200;
                     }
                     if(player.x+32 >= 50 && player.y +73<= 50){
                         bullet.body.velocity.x = +100;
                         bullet.body.velocity.y = -100;
                         bulletTime = game.time.now + 200;
                     }
                     if(player.x+32 <= 50 && player.y +73>= 50){
                         bullet.body.velocity.x = -100;
                         bullet.body.velocity.y = +100;
                         bulletTime = game.time.now + 200;
                     }
                     if(player.x+32 >= 50 && player.y +73>= 50){
                         bullet.body.velocity.x = +100;
                         bullet.body.velocity.y = +100;
                         bulletTime = game.time.now + 200;
                     }
//                     bullet.body.velocity.y=-400;
//                     bulletTime =game.time.now +200
                 }
             } 
          }
          
          
            
            
          
        }
        function render() {

            game.debug.text('Elapsed seconds: ' + this.game.time.totalElapsedSeconds(), 32, 32);

        }

        
    </script>
  </body>
</html>
